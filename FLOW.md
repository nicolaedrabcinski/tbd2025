# Roadmap проекта NHL DWH (100+ задач)

## 1. Подготовка среды (20 задач)
1. [x] Установить PostgreSQL на Linux-сервер.
2. [x] Настроить пользователя и права для БД.
3. [x] Установить Docker и Docker Compose.
4. [x] Развернуть Prefect в Docker. <-
5. [ ] Настроить подключение Prefect к PostgreSQL.
   1. [ ] https://linen.prefect.io/t/22697098/does-anyone-have-a-working-docker-compose-file-for-prefect-3
   2. [ ] https://github.com/PrefectHQ/prefect-background-task-examples/blob/main/chaos-duck/docker-compose.yaml
   3. [ ] https://linen.prefect.io/t/26789998/ulva73b9p-give-me-docker-compose-to-setup-prefect3-locally
   4. [ ] https://wasit7.medium.com/building-a-simple-prefect-3-data-pipeline-with-jupyter-and-docker-7eeac8f7df0f
   5. [ ] https://medium.com/the-prefect-blog/how-to-self-host-prefect-orion-with-postgres-using-docker-compose-631c41ab8a9f
   6. [ ] https://docs.prefect.io/v3/deploy/infrastructure-examples/docker
   7. [ ] https://www.restack.io/docs/prefect-knowledge-prefect-postgres-example
   8. [ ] https://www.restack.io/docs/prefect-knowledge-prefect-postgres-integration#clp7bhdcx03x6z80up3oiurs8
   9. [ ] https://www.restack.io/docs/prefect-knowledge-prefect-postgresql-integration#clp8nv78g066xyp0u7bqsnn7d
   10. [ ] https://www.restack.io/docs/prefect-knowledge-prefect-postgresql-integration#clp8nv78g066xyp0u7bqsnn7d
   11. [ ] https://www.restack.io/docs/prefect-knowledge-prefect-postgres-db-integration
   12. [ ] https://github.com/PrefectHQ/examples
6. [x] Установить Python 3.10 и необходимые библиотеки (polars, requests).
7. [x] Создать виртуальное окружение для Python в Poetry.
8. [x] Настроить SSH-доступ к серверу.
9. [ ] Установить pgAdmin для администрирования PostgreSQL.
10. Настроить брандмауэр для доступа к портам БД.
11. Создать резервную копию пустой БД.
12. Настроить автоматическое обновление системы.
13. Установить утилиты мониторинга (htop, glances).
14. Настроить логирование действий в системе.
15. Создать репозиторий Git для проекта.
16. Написать базовый .gitignore.
17. Установить Apache NiFi для альтернативного ETL.
18. Настроить проброс портов для доступа к Airflow.
19. Проверить работу всех установленных компонентов.
20. Задокументировать шаги установки.

## 2. Сбор данных (15 задач)
21. [ ] Получить API-ключ NHL (если требуется).
    1.  [ ] https://developer.sportradar.com/ice-hockey/reference/nhl-schedule
    2.  [ ] https://console.sportradar.com/accounts/681b1befd8c98411cfb71bcb/681b1befd8c98411cfb71bcc/subscriptions/681b2155fce1899c57e7b65d
22. Написать Python-скрипт для запроса данных матчей.
23. Реализовать обработку ошибок API-запросов.
24. Сохранить сырые данные в формате JSON.
25. Создать парсер для преобразования JSON в CSV.
26. Настроить ежедневный сбор данных через cron.
27. Добавить обработку исторических данных за 2023 год.
28. Реализовать проверку дубликатов при сборе данных.
29. Создать архив сырых данных.
30. Настроить Airflow DAG для ETL-процесса.
31. Реализовать уведомления об ошибках в Telegram.
32. Добавить сбор данных о составе команд.
33. Настроить парсинг данных о голевых передачах.
34. Собрать статистику вратарей.
35. Реализовать потоковую загрузку данных.

## 3. Проектирование DWH (25 задач)
36. Создать таблицу `dim_teams` (команды).
37. Создать таблицу `dim_players` (игроки).
38. Создать таблицу `dim_matches` (матчи).
39. Создать таблицу `fact_goals` (голы).
40. Добавить внешние ключи между таблицами.
41. Реализовать индексы для часто используемых полей.
42. Настроить секционирование таблицы матчей по датам.
43. Создать материализованные представления.
44. Реализовать триггеры для автоматического обновления статистики.
45. Настроить репликацию БД для отказоустойчивости.
46. Оптимизировать запросы через EXPLAIN ANALYZE.
47. Реализовать хранимые процедуры для часто используемых операций.
48. Создать пользовательские типы данных для позиций игроков.
49. Настроить полнотекстовый поиск по игрокам.
50. Реализовать constraints для валидации данных.
51. Создать таблицу `dim_periods` (периоды игры).
52. Добавить таблицу `bridge_lineups` (составы на матч).
53. Реализовать историчность данных через SCD2.
54. Настроить шифрование чувствительных данных.
55. Создать резервные копии схемы БД.
56. Реализовать миграции через Flyway.
57. Настроить мониторинг производительности запросов.
58. Оптимизировать использование памяти PostgreSQL.
59. Реализовать каскадное удаление связанных данных.
60. Провести нагрузочное тестирование БД.

## 4. Аналитика и OLAP (20 задач)
61. Установить Cube.js.
62. Настроить подключение Cube.js к PostgreSQL.
63. Создать базовый куб для анализа матчей.
64. Определить меру "Общее количество голов".
65. Добавить измерение "Периоды игры".
66. Реализовать расчет средней скорости гола.
67. Создать куб для анализа эффективности игроков.
68. Настроить ролевую модель доступа к данным.
69. Реализовать кэширование запросов в Cube.js.
70. Интегрировать Apache Superset как альтернативу.
71. Настроить запланированное обновление кубов.
72. Реализовать прогнозирование результатов матчей.
73. Создать API для доступа к аналитическим данным.
74. Добавить поддержу временных рядов через TimescaleDB.
75. Реализовать A/B-тестирование моделей данных.
76. Настроить алертинг для аномалий в данных.
77. Создать дашборд "Топ-10 бомбардиров".
78. Реализовать сравнение команд по ключевым метрикам.
79. Добавить географическую визуализацию матчей.
80. Интегрировать машинное обучение через Python.

## 5. Визуализация (15 задач)
81. Установить Metabase.
82. Настроить подключение Metabase к DWH.
83. Создать базовый дашборд "Общая статистика".
84. Реализовать фильтры по дате и командам.
85. Добавить график "Голы по периодам".
86. Создать отчет "Составы команд".
87. Настроить экспорт отчетов в PDF.
88. Реализовать shared dashboard для команд.
89. Интегрировать дашборды в веб-сайт через iframe.
90. Настроить темную тему для дашбордов.
91. Добавить пользовательские SQL-запросы.
92. Реализовать drill-down до уровня игрока.
93. Создать мобильную версию дашбордов.
94. Настроить автоматическую рассылку отчетов.
95. Провести юзабилити-тестирование интерфейса.

## 6. Тестирование (15 задач)
96. Написать unit-тесты для ETL-процессов.
97. Реализовать интеграционные тесты для БД.
98. Проверить целостность внешних ключей.
99. Протестировать восстановление из резервной копии.
100. Провести нагрузочное тестирование API.
101. Реализовать проверку качества данных (DQ).
102. Найти и исправить медленные запросы.
103. Протестировать отказоустойчивость системы.
104. Проверить работу в разных часовых поясах.
105. Реализовать chaos-тестирование инфраструктуры.
106. Провести security audit системы.
107. Написать тесты для Cube.js.
108. Проверить корректность OLAP-расчетов.
109. Протестировать работу системы при потере данных.
110. Реализовать end-to-end тестирование.

## 7. Документация (10 задач)
111. Написать ER-диаграмму системы.
112. Создать архитектурную схему решения.
113. Задокументировать API endpoints.
114. Составить руководство пользователя для аналитиков.
115. Написать инструкцию по аварийному восстановлению.
116. Создать словарь данных (data dictionary).
117. Задокументировать все процессы ETL.
118. Подготовить презентацию для стейкхолдеров.
119. Написать техническое описание инфраструктуры.
120. Создать чек-лист для деплоя системы.

## 8. Оптимизация и поддержка (10 задач)
121. Реализовать автоматическое масштабирование ресурсов.
122. Настроить мониторинг через Prometheus+Grafana.
123. Оптимизировать стоимость хранения данных.
124. Реализовать lifecycle-менеджмент для данных.
125. Настроить автоматическую очистку логов.
126. Провести рефакторинг кодовой базы.
127. Реализовать feature toggles для новых функций.
128. Настроить canary-деплойменты изменений.
129. Создать систему сбора обратной связи.
130. Планирование roadmap следующих версий.