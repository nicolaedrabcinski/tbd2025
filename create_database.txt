postgres=# CREATE DATABASE hockey_database;
CREATE DATABASE
postgres=# CREATE USER hockey_database_user WITH ENCRYPTED PASSWORD 'hockey_password';
CREATE ROLE
postgres=# GRANT ALL PRIVILEGES ON DATABASE hockey_database to hockey_database_user;
GRANT
postgres=# ALTER DATABASE hockey_database OWNER TO hockey_database_user;
ALTER DATABASE
postgres=# 


Создайте файл .env для переменных окружения:

echo 'PG_USER="myuser"
PG_PASS="mypassword"
PG_HOST="host.docker.internal"
PG_PORT="5432"
PG_DB="mydb"
PREFECT_API_URL="http://localhost:4200/api"' > .env

import os
from dotenv import load_dotenv
from prefect_sqlalchemy import SqlAlchemyConnector

load_dotenv()

connector = SqlAlchemyConnector(
    connection_info={
        "driver": "postgresql+psycopg2",
        "username": os.getenv("PG_USER"),
        "password": os.getenv("PG_PASS"),
        "host": os.getenv("PG_HOST"),
        "port": os.getenv("PG_PORT"),
        "database": os.getenv("PG_DB"),
    }
)
connector.save(name="postgres-conn")